<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Locação de Impressoras | Casa da Impressora</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body { font-family: Arial, sans-serif; margin:0; background:#f4f6f8; color:#222; }
header { background:#0b5ed7; color:#fff; padding:25px; text-align:center; }
main { max-width:1100px; margin:30px auto; padding:0 15px; }
h2 { margin-top:40px; }
.card { background:#fff; border-radius:12px; padding:20px; margin-bottom:25px; box-shadow:0 0 12px rgba(0,0,0,.08); }

.gallery {
  display:grid;
  grid-template-columns: repeat(auto-fill,minmax(220px,1fr));
  gap:15px;
}
.gallery img {
  width:100%;
  border-radius:10px;
  cursor:pointer;
  transition:.2s;
  object-fit: cover;
  aspect-ratio: 4/3;
}
.gallery img:hover { transform:scale(1.03); }

.video iframe { width:100%; height:420px; border-radius:12px; border:0; }

ul { padding-left:20px; }
.price { font-size:28px; font-weight:900; color:#0b5ed7; }

label { font-weight:700; margin-top:12px; display:block; }
input, select, textarea { width:100%; padding:12px; border-radius:8px; border:1px solid #ccc; margin-top:5px; font-size:14px; }

.grid-form {
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:12px;
}
@media (max-width: 780px){
  .grid-form { grid-template-columns: 1fr; }
  .video iframe { height:320px; }
}

.result { margin-top:15px; font-weight:700; padding:12px; border-radius:10px; background:#f7f9fc; border:1px solid #e6e6e6; }
.muted { color:#666; font-size:13px; margin-top:8px; }

button {
  margin-top:14px;
  padding:14px;
  width:100%;
  background:#0b5ed7;
  color:#fff;
  border:none;
  border-radius:10px;
  font-size:16px;
  font-weight:800;
  cursor:pointer;
}
button:hover { background:#084298; }

button.secondary {
  background:#e9f2ff;
  color:#0b5ed7;
  border:1px solid #bcd3ff;
}
button.secondary:hover { filter:brightness(.97); }

.contract {
  font-size:14px;
  line-height:1.6;
  white-space:pre-line;
  background:#fafafa;
  border:1px solid #ddd;
  border-radius:10px;
  padding:20px;
}

footer { text-align:center; margin:30px 0; color:#666; }

.modal {
  position:fixed; inset:0; background:rgba(0,0,0,.75);
  display:none; align-items:center; justify-content:center;
  padding:18px;
  z-index:9999;
}
.modal img {
  max-width:min(980px, 96vw);
  max-height:88vh;
  border-radius:14px;
}
.modal .close {
  position:absolute; top:14px; right:14px;
  background:#fff; border:none; border-radius:999px;
  width:44px; height:44px; cursor:pointer; font-weight:900;
}
.badge {
  display:inline-block;
  padding:6px 10px;
  border-radius:999px;
  background:#e9f2ff;
  color:#0b5ed7;
  font-weight:900;
  font-size:12px;
}
</style>
</head>

<body>

<header>
  <h1>Locação de Impressoras</h1>
  <p>Casa da Impressora • Solução completa para sua empresa</p>
</header>

<main>

<div class="card">
  <div class="badge">Plano de Locação</div>
  <h2 style="margin:10px 0 0;">HP OfficeJet Pro 8610</h2>
  <p class="price">R$ 500,00 / mês</p>

  <ul>
    <li>Impressão colorida profissional</li>
    <li>Tinta pigmentada ou corante</li>
    <li>Sistema de tinta de alto rendimento</li>
    <li><strong>Franquia:</strong> 5.000 páginas/mês</li>
    <li><strong>+ R$ 0,12</strong> por página excedente</li>
    <li><strong>Manutenção inclusa</strong></li>
    <li><strong>Tintas inclusas</strong></li>
    <li><strong>Troca do equipamento</strong> caso necessário</li>
    <li>Prazo de entrega: até <strong>15 dias</strong></li>
    <li>Contrato mínimo: <strong>12 meses</strong></li>
  </ul>
</div>

<div class="card">
  <h2>Galeria do Equipamento</h2>
  <p class="muted">Clique nas fotos para ampliar.</p>
  <div class="gallery" id="gallery">
    <img src="imghp1.jpeg" alt="HP 8610 - 1">
    <img src="imghp2.jpeg" alt="HP 8610 - 2">
    <img src="imghp3.jpeg" alt="HP 8610 - 3">
    <img src="imghp4.jpeg" alt="HP 8610 - 4">
    <img src="imghp5.jpeg" alt="HP 8610 - 5">
    <img src="imghp6.jpeg" alt="HP 8610 - 6">
    <img src="imghp7.jpeg" alt="HP 8610 - 7">
  </div>
</div>

<div class="card video">
  <h2>Vídeo do Equipamento</h2>
  <iframe src="https://www.youtube.com/embed/uPhKGnC9QfA" allowfullscreen></iframe>
</div>

<div class="card">
  <h2>Simular Contratação</h2>

  <div class="grid-form">
    <div>
      <label>Nome</label>
      <input type="text" id="nome" placeholder="Seu nome">
    </div>

    <div>
      <label>WhatsApp</label>
      <input type="text" id="whatsapp" placeholder="(88) 99999-9999">
    </div>

    <div>
      <label>Quantidade média de páginas por mês</label>
      <input type="number" id="paginas" placeholder="Ex: 6000">
    </div>

    <div>
      <label>Preferência de tinta</label>
      <select id="tinta">
        <option value="Tanto faz">Tanto faz</option>
        <option value="Pigmentada">Pigmentada</option>
        <option value="Corante">Corante</option>
      </select>
    </div>
  </div>

  <label style="margin-top:12px;">Observações (opcional)</label>
  <textarea id="obs" rows="3" placeholder="Ex: preciso emitir nota, endereço, horário de entrega..."></textarea>

  <div class="result" id="resultado">Preencha e clique em <strong>Calcular</strong>.</div>

  <button class="secondary" onclick="calcular()">Calcular</button>
  <button onclick="enviar()">Enviar simulação no WhatsApp</button>

  <p class="muted">
    Ao enviar, a simulação também é registrada no nosso sistema para agilizar o atendimento.
  </p>
</div>

<div class="card">
  <h2>Contrato de Locação (Resumo)</h2>

  <div class="contract">
CONTRATO DE LOCAÇÃO DE EQUIPAMENTO DE IMPRESSÃO (RESUMO)

1. OBJETO
Locação de equipamento de impressão modelo HP OfficeJet Pro 8610, com finalidade de impressão colorida.

2. VIGÊNCIA
Contrato com prazo mínimo de 12 (doze) meses, contados a partir da data de entrega/instalação do equipamento.

3. VALOR E FRANQUIA
3.1. Valor mensal: R$ 500,00 (quinhentos reais).
3.2. Franquia: 5.000 (cinco mil) páginas por mês.
3.3. Excedente: R$ 0,12 (doze centavos) por página adicional acima da franquia.

4. INCLUSÕES
4.1. Manutenção preventiva e corretiva.
4.2. Fornecimento de tintas/insumos necessários à impressão, conforme uso regular e orientações técnicas.
4.3. Suporte técnico durante a vigência do contrato.

5. TROCA DE EQUIPAMENTO
Em caso de falha que impeça o funcionamento e não seja possível reparo em prazo razoável, a LOCADORA poderá substituir o equipamento por outro equivalente, sem custo adicional de locação.

6. OBRIGAÇÕES DO CLIENTE
6.1. Utilizar o equipamento conforme orientação e boas práticas.
6.2. Zelar pela integridade do equipamento, evitando quedas, umidade excessiva, adulterações e intervenções de terceiros.
6.3. Informar prontamente qualquer falha para suporte.

7. ENTREGA E INSTALAÇÃO
Prazo estimado de até 15 (quinze) dias após a confirmação/assinatura para entrega e instalação.

8. RESCISÃO
8.1. Rescisão antes do prazo mínimo pode gerar multa proporcional ao período restante, conforme condições do contrato completo.
8.2. Em caso de inadimplência, a LOCADORA poderá suspender o suporte e/ou recolher o equipamento, conforme previsto no contrato.

Observação: O contrato completo será enviado para assinatura após a aprovação da simulação.
  </div>
</div>

</main>

<footer>
© 2026 Casa da Impressora
</footer>

<!-- Modal imagens -->
<div class="modal" id="modal">
  <button class="close" id="closeBtn">X</button>
  <img id="modalImg" alt="Imagem ampliada">
</div>

<script type="module">
import { db } from "./firebase.js";
import {
  collection, addDoc, serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* ====== Galeria modal ====== */
const modal = document.getElementById("modal");
const modalImg = document.getElementById("modalImg");
const closeBtn = document.getElementById("closeBtn");

document.getElementById("gallery").addEventListener("click", (e) => {
  const img = e.target.closest("img");
  if (!img) return;
  modalImg.src = img.src;
  modal.style.display = "flex";
});
closeBtn.addEventListener("click", () => modal.style.display = "none");
modal.addEventListener("click", (e) => {
  if (e.target === modal) modal.style.display = "none";
});

/* ====== Simulação + Firestore ====== */
const FRANQUIA = 5000;
const VALOR_BASE = 500;
const VALOR_EXCEDENTE = 0.12;
const MODELO = "HP OfficeJet Pro 8610";

function onlyDigits(s){ return (s||"").toString().replace(/\D/g,""); }

window.calcular = function calcular(){
  const paginas = Number(document.getElementById("paginas").value || 0);
  const excedente = Math.max(0, paginas - FRANQUIA);
  const custoExtra = excedente * VALOR_EXCEDENTE;
  const total = VALOR_BASE + custoExtra;

  document.getElementById("resultado").innerHTML = `
    Franquia: ${FRANQUIA} páginas/mês<br>
    Excedente: ${excedente} páginas<br>
    Valor excedente: R$ ${custoExtra.toFixed(2)}<br>
    <strong>Total estimado: R$ ${total.toFixed(2)} / mês</strong>
  `;
};

async function salvarNoFirestore(payload){
  // grava em: locacoes
  await addDoc(collection(db, "locacoes"), {
    ...payload,
    criadoEm: serverTimestamp(),
    status: "Proposta enviada"
  });
}

window.enviar = async function enviar(){
  const nome = (document.getElementById("nome").value || "").trim();
  const whatsapp = (document.getElementById("whatsapp").value || "").trim();
  const paginas = Number(document.getElementById("paginas").value || 0);
  const tinta = document.getElementById("tinta").value || "Tanto faz";
  const obs = (document.getElementById("obs").value || "").trim();

  if (!nome || !whatsapp || !paginas) {
    alert("Preencha nome, WhatsApp e páginas/mês para enviar.");
    return;
  }

  const excedente = Math.max(0, paginas - FRANQUIA);
  const valorExcedente = excedente * VALOR_EXCEDENTE;
  const totalMensal = VALOR_BASE + valorExcedente;

  // 1) salva no Firestore
  try {
    await salvarNoFirestore({
      tipo: "locacao",
      modelo: MODELO,
      nome,
      whatsapp,
      telefone: whatsapp,
      paginasMes: paginas,
      franquia: FRANQUIA,
      valorBase: VALOR_BASE,
      valorExcedenteUnit: VALOR_EXCEDENTE,
      excedentePaginas: excedente,
      valorExcedenteTotal: Number(valorExcedente.toFixed(2)),
      totalMensal: Number(totalMensal.toFixed(2)),
      tintaPreferida: tinta,
      obs,
      prazoEntregaDias: 15,
      contratoMinimoMeses: 12
    });
  } catch (e) {
    console.error(e);
    alert("Permissão negada no Firestore (regras). Ajuste as regras e teste novamente.");
    return;
  }

  // 2) abre WhatsApp com mensagem
  const tel = onlyDigits(whatsapp);
  const telWpp = tel.startsWith("55") ? tel : ("55" + tel);

  const msg = `
Simulação de locação - HP 8610

Nome: ${nome}
WhatsApp: ${whatsapp}
Páginas/mês: ${paginas}
Franquia: ${FRANQUIA}
Excedente: ${excedente}
Total estimado: R$ ${totalMensal.toFixed(2)} / mês
Preferência de tinta: ${tinta}
Obs: ${obs || "-"}

Gostaria de avançar com a contratação.
  `.trim();

  window.open("https://wa.me/5588993687542?text=" + encodeURIComponent(msg), "_blank");
};
</script>

</body>
</html>
